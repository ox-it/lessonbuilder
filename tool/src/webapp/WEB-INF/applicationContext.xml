<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
	"http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

   <!-- Use the Sakai session factory, pre-configured, instead of one local to TaskList
        we are adding our HBM files to the Sakai session factory instead of creating
        our own copy of it -->
  <bean id="org.sakaiproject.springframework.orm.hibernate.impl.AdditionalHibernateMappingsImpl.lessonbuildertool"
        class="org.sakaiproject.springframework.orm.hibernate.impl.AdditionalHibernateMappingsImpl">
    <property name="mappingResources">
      <list>
        <value>simplepageitem.hbm.xml</value> 
	<value>simplepage.hbm.xml</value>
      </list>
    </property>
  </bean>
 
  <bean id="org.sakaiproject.lessonbuildertool.model.SimplePageToolDaoTarget"
        class="org.sakaiproject.lessonbuildertool.model.SimplePageToolDaoImpl"
        singleton="true">
    <property name="sessionFactory">
      <ref bean="org.sakaiproject.springframework.orm.hibernate.GlobalSessionFactory" />
    </property>
    <property name="toolManager" ref="org.sakaiproject.tool.api.ActiveToolManager" />
    <property name="securityService" ref="org.sakaiproject.authz.api.SecurityService" />
  </bean>

<!-- here's the version our code will access -->

  <bean id="org.sakaiproject.lessonbuildertool.model.SimplePageToolDao"
        class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean"
        singleton="true">
    <property name="transactionManager">
      <ref bean="org.sakaiproject.springframework.orm.hibernate.GlobalTransactionManager" />
    </property>
    <property name="target">
      <ref bean="org.sakaiproject.lessonbuildertool.model.SimplePageToolDaoTarget" />
    </property>
    <property name="proxyInterfaces">
      <list>
        <value>org.sakaiproject.lessonbuildertool.model.SimplePageToolDao</value>
      </list>
    </property>        
    <property name="transactionAttributes">
      <props>
        <prop key="*">PROPAGATION_REQUIRED</prop>
      </props>
    </property>
 </bean>

	<!-- Control the location of the html templates (default: content/templates/) -->
	<bean id="templateResolverStrategy" parent="CRITemplateResolverStrategy">
		<property name="baseDirectory" value="templates/" />
	</bean>

   <!-- Define the bean roots from the request scope file that are accessible 
    via incoming request URL -->
   <bean parent="requestAddressibleParent">
	  <property name="value" value="simplePageBean"/>
   </bean>

  <bean id="ignoreFossilizedValues" class="uk.org.ponder.springutil.BooleanFactory">
    <property name="value" value="true" />
  </bean>

  <bean parent="templateContributorParent">
    <property name="templateNames" value="sakai-FCKEditor"/>
    <property name="baseDirectory" value="templates/" />
  </bean>
  
  <bean id="org.sakaiproject.lessonbuildertool.service.GroupPermissionsService"
	class="org.sakaiproject.lessonbuildertool.service.GroupPermissionsService">
    <property name="forumEntity" ref="org.sakaiproject.lessonbuildertool.service.ForumEntity"/>
  </bean>

  <bean id="org.sakaiproject.lessonbuildertool.service.JForumEntity"
	class="org.sakaiproject.lessonbuildertool.service.JForumEntity">
    <property name="toolManager" ref="org.sakaiproject.tool.api.ActiveToolManager" />
  </bean>

  <bean id="org.sakaiproject.lessonbuildertool.service.ForumEntity"
	class="org.sakaiproject.lessonbuildertool.service.ForumEntity">
    <property name = "nextEntity" ref="org.sakaiproject.lessonbuildertool.service.JForumEntity" />
  </bean>
  
  <bean id="org.sakaiproject.lessonbuildertool.service.SimplePageToolService" 
        class="org.sakaiproject.lessonbuildertool.service.SimplePageToolService" init-method="init" lazy-init="false">
  </bean>

  <bean parent="org.sakaiproject.entitybroker.entityprovider.AbstractEntityProvider"
        class="org.sakaiproject.lessonbuildertool.service.LessonBuilderEntityProducer"
        init-method="init"
        destroy-method="destroy"
        singleton="true">

    <property name="simplePageToolDao">
      <ref bean="org.sakaiproject.lessonbuildertool.model.SimplePageToolDao" />
    </property>
    <property name="forumEntity" ref="org.sakaiproject.lessonbuildertool.service.ForumEntity"/>
  </bean>
 </beans>
